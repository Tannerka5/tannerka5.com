---
import BaseLayout from '../../layouts/BaseLayout.astro';
import ProjectDetailHero from '../../components/projects/ProjectDetailHero';
import ProjectTechStack from '../../components/projects/ProjectTechStack';
import ProjectOverview from '../../components/projects/ProjectOverview';
import ProjectChallenges from '../../components/projects/ProjectChallenges';
import ProjectLearnings from '../../components/projects/ProjectLearnings';
import ProjectMetrics from '../../components/projects/ProjectMetrics';
import ProjectMedia from '../../components/projects/ProjectMedia';
import ProjectNavigation from '../../components/projects/ProjectNavigation';
import AnimatedDivider from '../../components/AnimatedDivider';
import Breadcrumbs from '../../components/Breadcrumbs.astro';
import ProjectSchema from '../../components/ProjectSchema.astro';
import { projects } from '../../../data/projects';

export function getStaticPaths() {
  return projects.map((project) => ({
    params: { slug: project.slug },
    props: { project },
  }));
}

const { project } = Astro.props;
const allSlugs = projects.map((p) => p.slug);
---

<BaseLayout 
  title={`${project.title} | Projects`}
  description={project.shortDescription}
  ogImage={project.logo}
>
  <!-- Breadcrumbs -->
  <div class="bg-cream dark:bg-gray-900 pt-24 pb-4 px-4">
    <div class="max-w-7xl mx-auto">
      <Breadcrumbs 
        items={[
          { name: 'Projects', path: '/projects' },
          { name: project.title, path: `/projects/${project.slug}` }
        ]} 
      />
    </div>
  </div>

  <!-- Structured Data for Project -->
  <ProjectSchema 
    title={project.title}
    description={project.shortDescription}
    image={project.logo}
    techStack={project.techStack}
    url={project.links.live}
  />

  <ProjectDetailHero
    client:load
    title={project.title}
    role={project.role}
    timeline={project.timeline}
    gradientFrom={project.gradientFrom}
    gradientVia={project.gradientVia}
    gradientTo={project.gradientTo}
    logo={project.logo}
    icon={project.icon}
    links={project.links}
  />

  <AnimatedDivider client:load color="#6B9080" />

  <ProjectTechStack client:load techStack={project.techStack} />

  <AnimatedDivider client:load color="#2E5266" />
  
  <ProjectOverview
    client:load
    fullDescription={project.fullDescription}
    overview={project.detailed.overview}
    problem={project.detailed.problem}
    solution={project.detailed.solution}
  />

  <AnimatedDivider client:load color="#6B9080" />
  
  <ProjectChallenges client:load challenges={project.detailed.challenges} />

  <AnimatedDivider client:load color="#2E5266" />
  
  <ProjectLearnings
    client:load
    learnings={project.detailed.learnings}
    features={project.detailed.features}
  />

  <AnimatedDivider client:load color="#6B9080" />
  
  <ProjectMetrics client:load metrics={project.detailed.metrics} />

  <AnimatedDivider client:load color="#2E5266" />
  
  <ProjectMedia client:load media={project.detailed.media} />

  <AnimatedDivider client:load color="#6B9080" />
  
  <ProjectNavigation client:load currentSlug={project.slug} allSlugs={allSlugs} />
</BaseLayout>
